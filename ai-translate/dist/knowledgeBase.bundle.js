(()=>{"use strict";var n,e={365:(n,e,t)=>{t.d(e,{A:()=>a});var o=t(601),r=t.n(o),i=t(314),l=t.n(i)()(r());l.push([n.id,"body {\n    margin: 0;\n    padding: 0;\n    font-family: Arial, sans-serif;\n    background-color: #f5f5f5;\n}\n\n.app-container {\n    display: flex;\n    width: 100%;\n    height: 100vh;\n}\n\n.sidebar {\n    width: 17%;\n    padding: 0px;\n    background-color: #f8f9fa;\n    border-right: 1px solid #dee2e6;\n    overflow-y: auto;\n    display: flex;\n    flex-direction: column;\n}\n\n.main-content {\n    width: 83%;\n    padding: 0px;\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n}\n\n.file-input-container {\n    margin: 0px 10px 0px 10px;\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n    flex-shrink: 0;\n}\n\n.button-group {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    margin: 0px 0px;\n}\n\n.action-buttons-row {\n    display: flex;\n    gap: 10px;\n    width: 100%;\n}\n\n.action-buttons-row .btn {\n    flex: 1;\n}\n\n.source-lang-selector {\n    margin: 10px;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.select-input {\n    flex: 1;\n    padding: 5px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n}\n\n.log-container {\n    margin-top: 5px;\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    min-height: 0;\n}\n\n.log-container h3 {\n    margin: 0 0 10px 0;\n    flex-shrink: 0;\n}\n\n.log-output {\n    flex: 1;\n    width: 99%;\n    height: 200px;\n    overflow-y: auto;\n    overflow-x: hidden;\n    background-color: #f8f9fa;\n    border: 1px solid #e9ecef;\n    border-radius: 4px;\n    padding: 0px;\n    font-family: monospace;\n    font-size: 12px;\n}\n\n.excel-table-container {\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    background-color: white;\n    flex: 1;\n}\n\n.table-output {\n    width: 100%;\n    height: 100%;\n    background-color: white;\n}\n\n.excel-table {\n    width: 100%;\n    border-collapse: collapse;\n    table-layout: fixed; /* 使用固定表格布局，确保单元格宽度限制生效 */\n    min-width: 100%;\n    border-spacing: 0; /* 消除单元格间的间距 */\n}\n\n/* 第一列（行号列）的样式 */\n.excel-table td:first-child,\n.excel-table th:first-child {\n    min-width: 50px;\n    max-width: 80px;\n    text-align: center;\n    background-color: #f8f9fa;\n}\n\n.excel-table th,\n.excel-table td {\n    border: 1px solid #ddd;\n    padding: 8px;\n    text-align: left;\n    min-width: 100px;\n    max-width: 200px; /* 设置最大宽度为200px */\n    width: 200px; /* 固定宽度为200px */\n    white-space: normal;\n    word-wrap: break-word;\n    word-break: break-word; /* 允许在单词内部换行 */\n    overflow: visible; /* 改为可见，确保内容不被裁剪 */\n    height: auto !important; /* 高度自动调整，使用!important确保优先级 */\n    vertical-align: top; /* 内容顶部对齐 */\n    line-height: 1.5; /* 增加行高，使文本更易读 */\n    box-sizing: border-box; /* 确保内边距和边框不会增加元素宽度 */\n}\n\n.excel-table th {\n    background-color: #f8f9fa;\n    font-weight: bold;\n    position: sticky;\n    top: 0;\n    z-index: 10; /* 增加z-index确保表头始终在最上层 */\n    box-shadow: 0 2px 2px -1px rgba(0,0,0,0.1); /* 添加阴影增强视觉效果 */\n}\n\n.excel-table tr:nth-child(even) {\n    background-color: #f8f9fa;\n}\n\n.excel-table tr:hover {\n    background-color: #f5f5f5;\n}\n\n.upload-section {\n    border: 2px dashed #ccc;\n    padding: 20px;\n    text-align: center;\n    border-radius: 8px;\n    transition: all 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n}\n\n.upload-section.drag-over {\n    border-color: #2196F3;\n    background-color: rgba(33, 150, 243, 0.1);\n}\n\n.upload-hint {\n    color: #666;\n    margin: 0;\n    font-size: 14px;\n    transition: all 0.3s ease;\n}\n\n.upload-section.has-file .upload-hint {\n    font-size: 12px;\n    color: #999;\n}\n\n.file-name {\n    margin: 10px 0;\n    font-size: 14px;\n    color: #666;\n}\n\n/* 源语言选择器样式 */\n.source-lang-selector label {\n    color: #333;\n    font-size: 14px;\n    min-width: 70px;\n}\n\n/* 添加样式使单元格内容过多时能正确显示 */\n.excel-table tr {\n    height: auto !important; /* 行高自动调整 */\n}\n\n/* 确保长文本在单元格中正确换行 */\n.excel-table td div,\n.excel-table td span,\n.excel-table td p,\n.excel-table td {\n    max-width: 100%;\n    word-wrap: break-word;\n    word-break: break-word;\n    white-space: pre-wrap; /* 保留空白并允许换行 */\n    text-overflow: ellipsis; /* 文本过长时显示省略号 */\n}\n\n.select-input {\n    flex: 1;\n    padding: 8px 12px;\n    border: 1px solid #2196F3;\n    border-radius: 4px;\n    font-size: 14px;\n    color: #333;\n    background-color: white;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.select-input:hover {\n    border-color: #1976D2;\n}\n\n.select-input:focus {\n    outline: none;\n    border-color: #1976D2;\n    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\n}\n\n/* 按钮基础样式 */\n.btn {\n    padding: 8px 16px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    background-color: #2196F3;\n    color: white;\n    transition: background-color 0.3s;\n}\n\n.btn:hover {\n    background-color: #1976D2;\n}\n\n.btn:active {\n    background-color: #1565C0;\n}\n\n.btn:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n}\n\n/* 停止按钮样式 */\n.stop-btn {\n    background-color: #dc3545;\n    color: white;\n}\n\n.stop-btn:hover {\n    background-color: #c82333;\n}\n\n/* 翻译按钮样式 */\n.translate-btn {\n    padding: 8px 16px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    background-color: #4CAF50;\n    color: white;\n    transition: background-color 0.3s;\n}\n\n.translate-btn:hover {\n    background-color: #45a049;\n}\n\n.translate-btn:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n}\n\n/* 保存按钮样式 */\n#saveBtn, #saveJson {\n    background-color: #4CAF50;\n}\n\n#saveBtn:hover, #saveJson:hover {\n    background-color: #388E3C;\n}\n\n#saveExcel {\n    background-color: #4CAF50;\n}\n\n#saveExcel:hover {\n    background-color: #388E3C;\n}\n\n/* 进度条容器样式 */\n.progress-wrapper {\n    margin: 5px;\n    width: 95%;\n}\n\n.progress-container {\n    width: 100%;\n    height: 20px;\n    background-color: #f0f0f0;\n    border-radius: 4px;\n    overflow: hidden;\n    border: 1px solid #ddd;\n    position: relative;\n}\n\n.progress-fill {\n    height: 100%;\n    width: 0;\n    background-color: #4CAF50;\n    transition: width 0.3s ease;\n}\n\n.progress-text {\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n    color: #333;\n    font-size: 12px;\n    z-index: 1;\n}\n\n.progress-details {\n    margin-top: 5px;\n    font-size: 12px;\n    color: #666;\n    text-align: center;\n}\n\n.log-container h3 {\n    margin: 0 0 10px 0;\n    color: #333;\n    font-size: 14px;\n}\n\n.log-entry {\n    margin: 5px 0;\n    padding: 5px;\n    border-radius: 3px;\n    word-wrap: break-word;\n}\n\n.log-entry .timestamp {\n    color: #666;\n    margin-right: 8px;\n}\n\n.log-entry.error {\n    color: #dc3545;\n    background-color: rgba(220, 53, 69, 0.1);\n}\n\n.log-entry.warning {\n    color: #ffc107;\n    background-color: rgba(255, 193, 7, 0.1);\n}\n\n.log-entry.success {\n    color: #28a745;\n    background-color: rgba(40, 167, 69, 0.1);\n}\n\n.excel-table th {\n    background-color: #f8f9fa;\n    font-weight: bold;\n}\n\n.excel-table tr:nth-child(even) {\n    background-color: #f8f9fa;\n}\n\n.excel-table tr:hover {\n    background-color: #f5f5f5;\n}\n\n.table-scroll-container {\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n}\n\n.table-scroll-x {\n    width: 100%;\n    overflow-x: auto;\n}\n\n.table-scroll-y {\n    height: 100%;\n    overflow-y: auto;\n}\n\n.container {\n    display: flex;\n    flex-direction: column;\n    min-height: 100vh;\n    padding: 20px;\n    box-sizing: border-box;\n}\n\n.content-wrapper {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n}\n\n.timestamp {\n    color: #666;\n    font-size: 0.9em;\n    margin-right: 8px;\n}\n\n.error {\n    color: #cc0000;\n    padding: 10px;\n    margin: 10px 0;\n    background-color: #ffe8e8;\n    border: 1px solid #ffcccc;\n    border-radius: 4px;\n}\n\n.progress-container {\n    margin: 10px 0;\n    width: 100%;\n}\n\n.progress-bar {\n    width: 100%;\n    height: 20px;\n    background-color: #f0f0f0;\n    border-radius: 10px;\n    overflow: hidden;\n}\n\n.progress {\n    height: 100%;\n    background-color: #4CAF50;\n    transition: width 0.3s ease-in-out;\n}\n\n.progress-text {\n    margin-top: 5px;\n    text-align: center;\n    color: #666;\n    font-size: 14px;\n}\n",""]);const a=l},377:(n,e,t)=>{var o=t(72),r=t.n(o),i=t(825),l=t.n(i),a=t(659),s=t.n(a),c=t(56),d=t.n(c),h=t(540),u=t.n(h),p=t(113),b=t.n(p),g=t(365),f={};f.styleTagTransform=b(),f.setAttributes=d(),f.insert=s().bind(null,"head"),f.domAPI=l(),f.insertStyleElement=u(),r()(g.A,f),g.A&&g.A.locals&&g.A.locals;var y=function(n,e,t,o){return new(t||(t=Promise))((function(r,i){function l(n){try{s(o.next(n))}catch(n){i(n)}}function a(n){try{s(o.throw(n))}catch(n){i(n)}}function s(n){var e;n.done?r(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(l,a)}s((o=o.apply(n,e||[])).next())}))};const m=new class{constructor(){this.baseUrl="http://localhost:3000/api"}getStatus(){return y(this,void 0,void 0,(function*(){try{const n=yield fetch(`${this.baseUrl}/status`);if(!n.ok)throw new Error(`服务器响应错误: ${n.status}`);return yield n.json()}catch(n){throw console.error("获取服务器状态失败:",n),n}}))}getEntries(n){return y(this,arguments,void 0,(function*(n,e=100,t=0){try{let o=`${this.baseUrl}/entries?limit=${e}&offset=${t}`;n&&(o+=`&search=${encodeURIComponent(n)}`);const r=yield fetch(o);if(!r.ok)throw new Error(`获取条目失败: ${r.status}`);return yield r.json()}catch(n){throw console.error("获取条目失败:",n),n}}))}addEntry(n){return y(this,void 0,void 0,(function*(){try{const e=yield fetch(`${this.baseUrl}/entries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw new Error(`添加条目失败: ${e.status}`);return(yield e.json()).success}catch(n){throw console.error("添加条目失败:",n),n}}))}updateEntry(n,e){return y(this,void 0,void 0,(function*(){try{const t=yield fetch(`${this.baseUrl}/entries/${encodeURIComponent(n)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`更新条目失败: ${t.status}`);return(yield t.json()).success}catch(n){throw console.error("更新条目失败:",n),n}}))}deleteEntry(n){return y(this,void 0,void 0,(function*(){try{const e=yield fetch(`${this.baseUrl}/entries/${encodeURIComponent(n)}`,{method:"DELETE"});if(!e.ok)throw new Error(`删除条目失败: ${e.status}`);return(yield e.json()).success}catch(n){throw console.error("删除条目失败:",n),n}}))}importExcel(n){return y(this,void 0,void 0,(function*(){try{const e=new FormData;e.append("file",n);const t=yield fetch(`${this.baseUrl}/import`,{method:"POST",body:e});if(!t.ok)throw new Error(`导入Excel失败: ${t.status}`);return yield t.json()}catch(n){throw console.error("导入Excel失败:",n),n}}))}exportExcel(){return y(this,void 0,void 0,(function*(){try{const n=yield fetch(`${this.baseUrl}/export`);if(!n.ok)throw new Error(`导出Excel失败: ${n.status}`);return yield n.blob()}catch(n){throw console.error("导出Excel失败:",n),n}}))}initializeDatabase(){return y(this,void 0,void 0,(function*(){try{yield this.getStatus(),console.log("API服务器连接成功")}catch(n){throw console.error("API服务器连接失败:",n),new Error("无法连接到API服务器，请确保服务器已启动")}}))}};var x=function(n,e,t,o){return new(t||(t=Promise))((function(r,i){function l(n){try{s(o.next(n))}catch(n){i(n)}}function a(n){try{s(o.throw(n))}catch(n){i(n)}}function s(n){var e;n.done?r(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(l,a)}s((o=o.apply(n,e||[])).next())}))};class v{constructor(){this.currentEntries=[],this.selectedSourceLang="zh-CN",this.initializeDOMElements(),this.initializeDatabase(),this.initializeEventListeners()}initializeDOMElements(){this.fileInput=document.getElementById("fileInput"),this.fileName=document.getElementById("fileName"),this.uploadBtn=document.getElementById("uploadBtn"),this.importBtn=document.getElementById("importBtn"),this.actionButtons=document.getElementById("actionButtons"),this.logOutput=document.getElementById("logOutput"),this.progressFill=document.querySelector(".progress-fill"),this.progressText=document.querySelector(".progress-text"),this.progressDetails=document.querySelector(".progress-details"),this.searchInput=document.getElementById("searchInput"),this.searchBtn=document.getElementById("searchBtn"),this.kbTableOutput=document.getElementById("kbTableOutput"),this.addEntryBtn=document.getElementById("addEntryBtn"),this.deleteSelectedBtn=document.getElementById("deleteSelectedBtn"),this.sourceLang=document.getElementById("sourceLang")}initializeDatabase(){return x(this,void 0,void 0,(function*(){try{yield m.initializeDatabase(),this.log("API服务器连接成功"),yield this.loadEntries()}catch(n){this.log(`API服务器连接失败: ${n.message}`,"error")}}))}initializeEventListeners(){return x(this,void 0,void 0,(function*(){this.sourceLang.value=this.selectedSourceLang,this.sourceLang.addEventListener("change",(n=>{this.selectedSourceLang=n.target.value})),this.uploadBtn.addEventListener("click",(()=>{this.fileInput.click()})),this.fileInput.addEventListener("change",(n=>{const e=n.target.files;if(e&&e.length>0){const n=e[0];this.fileName.textContent=n.name,this.actionButtons.style.display="block"}})),this.importBtn.addEventListener("click",(()=>x(this,void 0,void 0,(function*(){const n=this.fileInput.files;if(n&&0!==n.length)try{const e=yield m.importExcel(n[0]);this.log(`导入成功，共导入 ${e.count} 条记录`),yield this.loadEntries(),this.fileInput.value="",this.fileName.textContent="",this.actionButtons.style.display="none"}catch(n){this.log(`导入失败: ${n.message}`,"error")}else this.log("请先选择要导入的文件","error")})))),this.searchBtn.addEventListener("click",(()=>{this.loadEntries(this.searchInput.value)})),this.searchInput.addEventListener("keypress",(n=>{"Enter"===n.key&&this.loadEntries(this.searchInput.value)})),this.addEntryBtn.addEventListener("click",(()=>{this.showAddEntryForm()})),this.deleteSelectedBtn.addEventListener("click",(()=>x(this,void 0,void 0,(function*(){const n=this.getSelectedEntryIds();if(0!==n.length){if(confirm(`确定要删除选中的 ${n.length} 条记录吗？`))try{let e=0;for(const t of n)(yield m.deleteEntry(t.toString()))&&e++;this.log(`成功删除 ${e} 条记录`),yield this.loadEntries()}catch(n){this.log(`删除失败: ${n.message}`,"error")}}else this.log("请先选择要删除的条目","error")}))))}))}loadEntries(n){return x(this,void 0,void 0,(function*(){try{this.log("加载翻译条目..."),this.currentEntries=yield m.getEntries(n),this.renderTable(this.currentEntries),this.log(`已加载 ${this.currentEntries.length} 条翻译条目`)}catch(n){this.log(`加载条目失败: ${n.message}`,"error")}}))}renderTable(n){const e=document.getElementById("kbTableOutput");if(!e)return;let t='\n            <table>\n                <thead>\n                    <tr>\n                        <th><input type="checkbox" id="selectAll"></th>\n                        <th>中文</th>\n                        <th>英文</th>\n                        <th>日文</th>\n                        <th>韩文</th>\n                        <th>西班牙文</th>\n                        <th>法文</th>\n                        <th>德文</th>\n                        <th>俄文</th>\n                        <th>泰文</th>\n                        <th>意大利文</th>\n                        <th>印尼文</th>\n                        <th>葡萄牙文</th>\n                        <th>操作</th>\n                    </tr>\n                </thead>\n                <tbody>\n        ';for(const e of n)t+=`\n                <tr data-id="${e.Chinese}">\n                    <td><input type="checkbox" class="entry-checkbox" data-id="${e.Chinese}"></td>\n                    <td>${this.escapeHtml(e.Chinese)}</td>\n                    <td>${this.escapeHtml(e.English)}</td>\n                    <td>${this.escapeHtml(e.Japanese)}</td>\n                    <td>${this.escapeHtml(e.Korean)}</td>\n                    <td>${this.escapeHtml(e.Spanish)}</td>\n                    <td>${this.escapeHtml(e.French)}</td>\n                    <td>${this.escapeHtml(e.German)}</td>\n                    <td>${this.escapeHtml(e.Russian)}</td>\n                    <td>${this.escapeHtml(e.Thai)}</td>\n                    <td>${this.escapeHtml(e.Italian)}</td>\n                    <td>${this.escapeHtml(e.Indonesian)}</td>\n                    <td>${this.escapeHtml(e.Portuguese)}</td>\n                    <td>\n                        <button class="btn-small view-btn" data-id="${e.Chinese}">查看</button>\n                        <button class="btn-small edit-btn" data-id="${e.Chinese}">编辑</button>\n                    </td>\n                </tr>\n            `;t+="\n                </tbody>\n            </table>\n        ",e.innerHTML=t;const o=document.getElementById("selectAll");o&&o.addEventListener("change",(()=>{document.querySelectorAll(".entry-checkbox").forEach((n=>{n.checked=o.checked}))})),document.querySelectorAll(".view-btn").forEach((n=>{n.addEventListener("click",(()=>{const e=n.getAttribute("data-id")||"",t=this.currentEntries.find((n=>n.Chinese===e));t&&this.showEntryDetails(t)}))})),document.querySelectorAll(".edit-btn").forEach((n=>{n.addEventListener("click",(()=>{const e=n.getAttribute("data-id")||"",t=this.currentEntries.find((n=>n.Chinese===e));t&&this.showEditEntryForm(t)}))}))}showEntryDetails(n){const e=document.createElement("div");e.className="modal";let t='\n            <div class="modal-content">\n                <span class="close">&times;</span>\n                <h2>查看翻译条目</h2>\n                <div class="entry-details">\n        ';[{key:"Chinese",label:"中文"},{key:"English",label:"英文"},{key:"Japanese",label:"日文"},{key:"Korean",label:"韩文"},{key:"Spanish",label:"西班牙文"},{key:"French",label:"法文"},{key:"German",label:"德文"},{key:"Russian",label:"俄文"},{key:"Thai",label:"泰文"},{key:"Italian",label:"意大利文"},{key:"Indonesian",label:"印尼文"},{key:"Portuguese",label:"葡萄牙文"}].forEach((e=>{const o=n[e.key];t+=`\n                <div class="entry-field">\n                    <label>${e.label}:</label>\n                    <div class="field-value">${this.escapeHtml((null==o?void 0:o.toString())||"")}</div>\n                </div>\n            `})),t+="\n                </div>\n            </div>\n        ",e.innerHTML=t,document.body.appendChild(e);const o=e.querySelector(".close");o&&o.addEventListener("click",(()=>{document.body.removeChild(e)}))}showEditEntryForm(n){const e=document.createElement("div");e.className="modal";const t=[{key:"Chinese",label:"中文"},{key:"English",label:"英文"},{key:"Japanese",label:"日文"},{key:"Korean",label:"韩文"},{key:"Spanish",label:"西班牙文"},{key:"French",label:"法文"},{key:"German",label:"德文"},{key:"Russian",label:"俄文"},{key:"Thai",label:"泰文"},{key:"Italian",label:"意大利文"},{key:"Indonesian",label:"印尼文"},{key:"Portuguese",label:"葡萄牙文"}];let o=`\n            <div class="modal-content">\n                <span class="close">&times;</span>\n                <h2>编辑翻译条目</h2>\n                <form id="editEntryForm">\n                    <input type="hidden" id="entryChinese" value="${n.Chinese}">\n        `;t.forEach((e=>{const t=n[e.key];o+=`\n                <div class="form-group">\n                    <label for="${e.key}">${e.label}:</label>\n                    <textarea id="${e.key}" class="form-control" rows="2">${this.escapeHtml((null==t?void 0:t.toString())||"")}</textarea>\n                </div>\n            `})),o+='\n                    <div class="form-group">\n                        <button type="submit" class="btn">保存</button>\n                        <button type="button" class="btn cancel-btn">取消</button>\n                    </div>\n                </form>\n            </div>\n        ',e.innerHTML=o,document.body.appendChild(e);const r=e.querySelector(".close"),i=e.querySelector(".cancel-btn"),l=()=>{document.body.removeChild(e)};r&&r.addEventListener("click",l),i&&i.addEventListener("click",l),e.querySelector("#editEntryForm").addEventListener("submit",(n=>x(this,void 0,void 0,(function*(){n.preventDefault();const o=document.getElementById("entryChinese").value,r={};t.forEach((n=>{const e=document.getElementById(n.key);r[n.key]=e.value}));try{yield m.updateEntry(o,r),this.log("条目更新成功"),document.body.removeChild(e),yield this.loadEntries()}catch(n){this.log(`更新失败: ${n.message}`,"error")}}))))}showAddEntryForm(){const n=document.createElement("div");n.className="modal";const e=[{key:"Chinese",label:"中文"},{key:"English",label:"英文"},{key:"Japanese",label:"日文"},{key:"Korean",label:"韩文"},{key:"Spanish",label:"西班牙文"},{key:"French",label:"法文"},{key:"German",label:"德文"},{key:"Russian",label:"俄文"},{key:"Thai",label:"泰文"},{key:"Italian",label:"意大利文"},{key:"Indonesian",label:"印尼文"},{key:"Portuguese",label:"葡萄牙文"}];let t='\n            <div class="modal-content">\n                <span class="close">&times;</span>\n                <h2>添加翻译条目</h2>\n                <form id="addEntryForm">\n        ';e.forEach((n=>{t+=`\n                <div class="form-group">\n                    <label for="${n.key}">${n.label}:</label>\n                    <textarea id="${n.key}" class="form-control" rows="2"></textarea>\n                </div>\n            `})),t+='\n                    <div class="form-group">\n                        <button type="submit" class="btn">保存</button>\n                        <button type="button" class="btn cancel-btn">取消</button>\n                    </div>\n                </form>\n            </div>\n        ',n.innerHTML=t,document.body.appendChild(n);const o=n.querySelector(".close"),r=n.querySelector(".cancel-btn"),i=()=>{document.body.removeChild(n)};o&&o.addEventListener("click",i),r&&r.addEventListener("click",i),n.querySelector("#addEntryForm").addEventListener("submit",(t=>x(this,void 0,void 0,(function*(){t.preventDefault();const o={};e.forEach((n=>{const e=document.getElementById(n.key);o[n.key]=e.value}));try{yield m.addEntry(o),this.log("条目添加成功"),document.body.removeChild(n),yield this.loadEntries()}catch(n){this.log(`添加失败: ${n.message}`,"error")}}))))}getSelectedEntryIds(){const n=[];return document.querySelectorAll(".entry-checkbox:checked").forEach((e=>{const t=e.getAttribute("data-id")||"";t&&n.push(t)})),n}log(n,e="info"){const t=document.getElementById("logOutput");if(!t)return;const o=document.createElement("div");o.className=`log-entry ${e}`,o.textContent=n,t.appendChild(o),t.scrollTop=t.scrollHeight}escapeHtml(n){return n?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}}document.addEventListener("DOMContentLoaded",(()=>{window.knowledgeBaseManagerInstance=new v}))}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={id:n,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}o.m=e,n=[],o.O=(e,t,r,i)=>{if(!t){var l=1/0;for(d=0;d<n.length;d++){for(var[t,r,i]=n[d],a=!0,s=0;s<t.length;s++)(!1&i||l>=i)&&Object.keys(o.O).every((n=>o.O[n](t[s])))?t.splice(s--,1):(a=!1,i<l&&(l=i));if(a){n.splice(d--,1);var c=r();void 0!==c&&(e=c)}}return e}i=i||0;for(var d=n.length;d>0&&n[d-1][2]>i;d--)n[d]=n[d-1];n[d]=[t,r,i]},o.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return o.d(e,{a:e}),e},o.d=(n,e)=>{for(var t in e)o.o(e,t)&&!o.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),(()=>{var n={450:0};o.O.j=e=>0===n[e];var e=(e,t)=>{var r,i,[l,a,s]=t,c=0;if(l.some((e=>0!==n[e]))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(s)var d=s(o)}for(e&&e(t);c<l.length;c++)i=l[c],o.o(n,i)&&n[i]&&n[i][0](),n[i]=0;return o.O(d)},t=self.webpackChunkexcel_to_structured_data=self.webpackChunkexcel_to_structured_data||[];t.forEach(e.bind(null,0)),t.push=e.bind(null,t.push.bind(t))})(),o.nc=void 0;var r=o.O(void 0,[121],(()=>o(377)));r=o.O(r)})();