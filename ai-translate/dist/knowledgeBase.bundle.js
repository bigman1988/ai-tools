(()=>{var n,e={3:()=>{},365:(n,e,t)=>{"use strict";t.d(e,{A:()=>s});var o=t(1601),r=t.n(o),i=t(6314),a=t.n(i)()(r());a.push([n.id,"body {\n    margin: 0;\n    padding: 0;\n    font-family: Arial, sans-serif;\n    background-color: #f5f5f5;\n}\n\n.app-container {\n    display: flex;\n    width: 100%;\n    height: 100vh;\n}\n\n.sidebar {\n    width: 17%;\n    padding: 0px;\n    background-color: #f8f9fa;\n    border-right: 1px solid #dee2e6;\n    overflow-y: auto;\n    display: flex;\n    flex-direction: column;\n}\n\n.main-content {\n    width: 83%;\n    padding: 0px;\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n}\n\n.file-input-container {\n    margin: 0px 10px 0px 10px;\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n    flex-shrink: 0;\n}\n\n.button-group {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    margin: 0px 0px;\n}\n\n.action-buttons-row {\n    display: flex;\n    gap: 10px;\n    width: 100%;\n}\n\n.action-buttons-row .btn {\n    flex: 1;\n}\n\n.source-lang-selector {\n    margin: 10px;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.select-input {\n    flex: 1;\n    padding: 5px;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n}\n\n.log-container {\n    margin-top: 5px;\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    min-height: 0;\n}\n\n.log-container h3 {\n    margin: 0 0 10px 0;\n    flex-shrink: 0;\n}\n\n.log-output {\n    flex: 1;\n    width: 99%;\n    height: 200px;\n    overflow-y: auto;\n    overflow-x: hidden;\n    background-color: #f8f9fa;\n    border: 1px solid #e9ecef;\n    border-radius: 4px;\n    padding: 0px;\n    font-family: monospace;\n    font-size: 12px;\n}\n\n.excel-table-container {\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    border: 1px solid #ddd;\n    border-radius: 4px;\n    background-color: white;\n    flex: 1;\n}\n\n.table-output {\n    width: 100%;\n    height: 100%;\n    background-color: white;\n}\n\n.excel-table {\n    width: 100%;\n    border-collapse: collapse;\n    table-layout: fixed; /* 使用固定表格布局，确保单元格宽度限制生效 */\n    min-width: 100%;\n    border-spacing: 0; /* 消除单元格间的间距 */\n}\n\n/* 第一列（行号列）的样式 */\n.excel-table td:first-child,\n.excel-table th:first-child {\n    min-width: 50px;\n    max-width: 80px;\n    text-align: center;\n    background-color: #f8f9fa;\n}\n\n.excel-table th,\n.excel-table td {\n    border: 1px solid #ddd;\n    padding: 8px;\n    text-align: left;\n    min-width: 100px;\n    max-width: 200px; /* 设置最大宽度为200px */\n    width: 200px; /* 固定宽度为200px */\n    white-space: normal;\n    word-wrap: break-word;\n    word-break: break-word; /* 允许在单词内部换行 */\n    overflow: visible; /* 改为可见，确保内容不被裁剪 */\n    height: auto !important; /* 高度自动调整，使用!important确保优先级 */\n    vertical-align: top; /* 内容顶部对齐 */\n    line-height: 1.5; /* 增加行高，使文本更易读 */\n    box-sizing: border-box; /* 确保内边距和边框不会增加元素宽度 */\n}\n\n.excel-table th {\n    background-color: #f8f9fa;\n    font-weight: bold;\n    position: sticky;\n    top: 0;\n    z-index: 10; /* 增加z-index确保表头始终在最上层 */\n    box-shadow: 0 2px 2px -1px rgba(0,0,0,0.1); /* 添加阴影增强视觉效果 */\n}\n\n.excel-table tr:nth-child(even) {\n    background-color: #f8f9fa;\n}\n\n.excel-table tr:hover {\n    background-color: #f5f5f5;\n}\n\n.upload-section {\n    border: 2px dashed #ccc;\n    padding: 20px;\n    text-align: center;\n    border-radius: 8px;\n    transition: all 0.3s ease;\n    display: flex;\n    flex-direction: column;\n    gap: 15px;\n}\n\n.upload-section.drag-over {\n    border-color: #2196F3;\n    background-color: rgba(33, 150, 243, 0.1);\n}\n\n.upload-hint {\n    color: #666;\n    margin: 0;\n    font-size: 14px;\n    transition: all 0.3s ease;\n}\n\n.upload-section.has-file .upload-hint {\n    font-size: 12px;\n    color: #999;\n}\n\n.file-name {\n    margin: 10px 0;\n    font-size: 14px;\n    color: #666;\n}\n\n/* 源语言选择器样式 */\n.source-lang-selector label {\n    color: #333;\n    font-size: 14px;\n    min-width: 70px;\n}\n\n/* 添加样式使单元格内容过多时能正确显示 */\n.excel-table tr {\n    height: auto !important; /* 行高自动调整 */\n}\n\n/* 确保长文本在单元格中正确换行 */\n.excel-table td div,\n.excel-table td span,\n.excel-table td p,\n.excel-table td {\n    max-width: 100%;\n    word-wrap: break-word;\n    word-break: break-word;\n    white-space: pre-wrap; /* 保留空白并允许换行 */\n    text-overflow: ellipsis; /* 文本过长时显示省略号 */\n}\n\n.select-input {\n    flex: 1;\n    padding: 8px 12px;\n    border: 1px solid #2196F3;\n    border-radius: 4px;\n    font-size: 14px;\n    color: #333;\n    background-color: white;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.select-input:hover {\n    border-color: #1976D2;\n}\n\n.select-input:focus {\n    outline: none;\n    border-color: #1976D2;\n    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\n}\n\n/* 按钮基础样式 */\n.btn {\n    padding: 8px 16px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    background-color: #2196F3;\n    color: white;\n    transition: background-color 0.3s;\n}\n\n.btn:hover {\n    background-color: #1976D2;\n}\n\n.btn:active {\n    background-color: #1565C0;\n}\n\n.btn:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n}\n\n/* 停止按钮样式 */\n.stop-btn {\n    background-color: #dc3545;\n    color: white;\n}\n\n.stop-btn:hover {\n    background-color: #c82333;\n}\n\n/* 翻译按钮样式 */\n.translate-btn {\n    padding: 8px 16px;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    background-color: #4CAF50;\n    color: white;\n    transition: background-color 0.3s;\n}\n\n.translate-btn:hover {\n    background-color: #45a049;\n}\n\n.translate-btn:disabled {\n    background-color: #cccccc;\n    cursor: not-allowed;\n}\n\n/* 保存按钮样式 */\n#saveBtn, #saveJson {\n    background-color: #4CAF50;\n}\n\n#saveBtn:hover, #saveJson:hover {\n    background-color: #388E3C;\n}\n\n#saveExcel {\n    background-color: #4CAF50;\n}\n\n#saveExcel:hover {\n    background-color: #388E3C;\n}\n\n/* 进度条容器样式 */\n.progress-wrapper {\n    margin: 5px;\n    width: 95%;\n}\n\n.progress-container {\n    width: 100%;\n    height: 20px;\n    background-color: #f0f0f0;\n    border-radius: 4px;\n    overflow: hidden;\n    border: 1px solid #ddd;\n    position: relative;\n}\n\n.progress-fill {\n    height: 100%;\n    width: 0;\n    background-color: #4CAF50;\n    transition: width 0.3s ease;\n}\n\n.progress-text {\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n    color: #333;\n    font-size: 12px;\n    z-index: 1;\n}\n\n.progress-details {\n    margin-top: 5px;\n    font-size: 12px;\n    color: #666;\n    text-align: center;\n}\n\n.log-container h3 {\n    margin: 0 0 10px 0;\n    color: #333;\n    font-size: 14px;\n}\n\n.log-entry {\n    margin: 5px 0;\n    padding: 5px;\n    border-radius: 3px;\n    word-wrap: break-word;\n}\n\n.log-entry .timestamp {\n    color: #666;\n    margin-right: 8px;\n}\n\n.log-entry.error {\n    color: #dc3545;\n    background-color: rgba(220, 53, 69, 0.1);\n}\n\n.log-entry.warning {\n    color: #ffc107;\n    background-color: rgba(255, 193, 7, 0.1);\n}\n\n.log-entry.success {\n    color: #28a745;\n    background-color: rgba(40, 167, 69, 0.1);\n}\n\n.excel-table th {\n    background-color: #f8f9fa;\n    font-weight: bold;\n}\n\n.excel-table tr:nth-child(even) {\n    background-color: #f8f9fa;\n}\n\n.excel-table tr:hover {\n    background-color: #f5f5f5;\n}\n\n.table-scroll-container {\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n}\n\n.table-scroll-x {\n    width: 100%;\n    overflow-x: auto;\n}\n\n.table-scroll-y {\n    height: 100%;\n    overflow-y: auto;\n}\n\n.container {\n    display: flex;\n    flex-direction: column;\n    min-height: 100vh;\n    padding: 20px;\n    box-sizing: border-box;\n}\n\n.content-wrapper {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n}\n\n.timestamp {\n    color: #666;\n    font-size: 0.9em;\n    margin-right: 8px;\n}\n\n.error {\n    color: #cc0000;\n    padding: 10px;\n    margin: 10px 0;\n    background-color: #ffe8e8;\n    border: 1px solid #ffcccc;\n    border-radius: 4px;\n}\n\n.progress-container {\n    margin: 10px 0;\n    width: 100%;\n}\n\n.progress-bar {\n    width: 100%;\n    height: 20px;\n    background-color: #f0f0f0;\n    border-radius: 10px;\n    overflow: hidden;\n}\n\n.progress {\n    height: 100%;\n    background-color: #4CAF50;\n    transition: width 0.3s ease-in-out;\n}\n\n.progress-text {\n    margin-top: 5px;\n    text-align: center;\n    color: #666;\n    font-size: 14px;\n}\n",""]);const s=a},1069:()=>{},1638:()=>{},2634:()=>{},2668:()=>{},3776:()=>{},4688:()=>{},5070:(n,e,t)=>{"use strict";var o=t(5072),r=t.n(o),i=t(7825),a=t.n(i),s=t(7659),l=t.n(s),d=t(5056),c=t.n(d),h=t(540),u=t.n(h),p=t(1113),g=t.n(p),m=t(365),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=a(),b.insertStyleElement=u(),r()(m.A,b),m.A&&m.A.locals&&m.A.locals;var f=t(4451),x=t(3195),E=function(n,e,t,o){return new(t||(t=Promise))((function(r,i){function a(n){try{l(o.next(n))}catch(n){i(n)}}function s(n){try{l(o.throw(n))}catch(n){i(n)}}function l(n){var e;n.done?r(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(a,s)}l((o=o.apply(n,e||[])).next())}))};const v=new class{constructor(){this.pool=x.createPool({host:"172.16.0.78",user:"root",password:"123456",database:"translation_knowledge",waitForConnections:!0,connectionLimit:10,queueLimit:0})}initializeDatabase(){return E(this,void 0,void 0,(function*(){try{yield this.pool.execute("\n                CREATE TABLE IF NOT EXISTS `translate-cn` (\n                    id INT AUTO_INCREMENT PRIMARY KEY,\n                    Chinese TEXT,\n                    English TEXT,\n                    Japanese TEXT,\n                    Korean TEXT,\n                    Spanish TEXT,\n                    French TEXT,\n                    German TEXT,\n                    Russian TEXT,\n                    Thai TEXT,\n                    Italian TEXT,\n                    Indonesian TEXT,\n                    Portuguese TEXT,\n                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n                    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n                )\n            "),console.log("Database initialized successfully")}catch(n){throw console.error("Error initializing database:",n),n}}))}addEntry(n){return E(this,void 0,void 0,(function*(){try{const[e]=yield this.pool.execute("INSERT INTO `translate-cn` (Chinese, English, Japanese, Korean, Spanish, French, German, Russian, Thai, Italian, Indonesian, Portuguese) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",[n.Chinese||"",n.English||"",n.Japanese||"",n.Korean||"",n.Spanish||"",n.French||"",n.German||"",n.Russian||"",n.Thai||"",n.Italian||"",n.Indonesian||"",n.Portuguese||""]);return e.insertId}catch(n){throw console.error("Error adding entry to translation table:",n),n}}))}getEntries(n){return E(this,arguments,void 0,(function*(n,e=100,t=0){try{let o="SELECT * FROM `translate-cn` WHERE 1=1";const r=[];if(n){o+=" AND (Chinese LIKE ? OR English LIKE ? OR Japanese LIKE ? OR Korean LIKE ? OR Spanish LIKE ? OR French LIKE ? OR German LIKE ? OR Russian LIKE ? OR Thai LIKE ? OR Italian LIKE ? OR Indonesian LIKE ? OR Portuguese LIKE ?)";const e=`%${n}%`;r.push(e,e,e,e,e,e,e,e,e,e,e,e)}o+=" ORDER BY id DESC LIMIT ? OFFSET ?",r.push(e,t);const[i]=yield this.pool.execute(o,r);return i}catch(n){throw console.error("Error getting entries from translation table:",n),n}}))}updateEntry(n,e){return E(this,void 0,void 0,(function*(){try{const t=[],o=[],r=["Chinese","English","Japanese","Korean","Spanish","French","German","Russian","Thai","Italian","Indonesian","Portuguese"];for(const n of r)void 0!==e[n]&&(t.push(`${n} = ?`),o.push(e[n]));if(0===t.length)return!1;o.push(n);const[i]=yield this.pool.execute(`UPDATE \`translate-cn\` SET ${t.join(", ")} WHERE id = ?`,o);return i.affectedRows>0}catch(n){throw console.error("Error updating entry in translation table:",n),n}}))}deleteEntry(n){return E(this,void 0,void 0,(function*(){try{const[e]=yield this.pool.execute("DELETE FROM `translate-cn` WHERE id = ?",[n]);return e.affectedRows>0}catch(n){throw console.error("Error deleting entry from translation table:",n),n}}))}bulkImport(n){return E(this,void 0,void 0,(function*(){try{if(0===n.length)return 0;const e=n.map((()=>"(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)")).join(", "),t=n.flatMap((n=>[n.Chinese||"",n.English||"",n.Japanese||"",n.Korean||"",n.Spanish||"",n.French||"",n.German||"",n.Russian||"",n.Thai||"",n.Italian||"",n.Indonesian||"",n.Portuguese||""])),[o]=yield this.pool.execute(`INSERT INTO \`translate-cn\` (Chinese, English, Japanese, Korean, Spanish, French, German, Russian, Thai, Italian, Indonesian, Portuguese) VALUES ${e}`,t);return o.affectedRows}catch(n){throw console.error("Error bulk importing entries to translation table:",n),n}}))}close(){return E(this,void 0,void 0,(function*(){yield this.pool.end()}))}};var y=function(n,e,t,o){return new(t||(t=Promise))((function(r,i){function a(n){try{l(o.next(n))}catch(n){i(n)}}function s(n){try{l(o.throw(n))}catch(n){i(n)}}function l(n){var e;n.done?r(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(a,s)}l((o=o.apply(n,e||[])).next())}))};const w=new class{constructor(){this.columnMapping={简体中文:"Chinese",英语:"English",日语:"Japanese",韩语:"Korean",西班牙语:"Spanish",法语:"French",德语:"German",俄语:"Russian",泰语:"Thai",意大利语:"Italian",印尼语:"Indonesian",葡萄牙语:"Portuguese"}}parseExcelFile(n){return y(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{const o=new FileReader;o.onload=n=>y(this,void 0,void 0,(function*(){var o;try{const t=new Uint8Array(null===(o=n.target)||void 0===o?void 0:o.result),r=f.read(t,{type:"array"}),i=r.SheetNames[0],a=r.Sheets[i],s=f.utils.sheet_to_json(a,{header:1,range:6}),l=f.utils.sheet_to_json(a,{header:1,range:1})[0],d={};l.forEach(((n,e)=>{this.columnMapping[n]&&(d[this.columnMapping[n]]=e)}));const c=[];s.forEach((n=>{if(!n||0===n.length||!n[0])return;const e={};Object.keys(this.columnMapping).forEach((t=>{const o=this.columnMapping[t],r=d[o];e[o]=void 0!==r&&n[r]||""})),c.push(e)})),e(c)}catch(n){console.error("解析Excel文件时出错:",n),t(n)}})),o.onerror=n=>{console.error("读取Excel文件时出错:",n),t(n)},o.readAsArrayBuffer(n)}))}))}importExcelToDatabase(n){return y(this,void 0,void 0,(function*(){try{yield v.initializeDatabase();const e=yield this.parseExcelFile(n);return 0===e.length?0:yield v.bulkImport(e)}catch(n){throw console.error("导入Excel到数据库时出错:",n),n}}))}};var k=function(n,e,t,o){return new(t||(t=Promise))((function(r,i){function a(n){try{l(o.next(n))}catch(n){i(n)}}function s(n){try{l(o.throw(n))}catch(n){i(n)}}function l(n){var e;n.done?r(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(a,s)}l((o=o.apply(n,e||[])).next())}))};class I{constructor(){this.selectedFile=null,this.currentEntries=[],this.fileInput=document.getElementById("fileInput"),this.fileName=document.getElementById("fileName"),this.uploadBtn=document.getElementById("uploadBtn"),this.importBtn=document.getElementById("importBtn"),this.exportBtn=document.getElementById("exportBtn"),this.actionButtons=document.getElementById("actionButtons"),this.logOutput=document.getElementById("logOutput"),this.progressFill=document.querySelector(".progress-fill"),this.progressText=document.querySelector(".progress-text"),this.progressDetails=document.querySelector(".progress-details"),this.searchInput=document.getElementById("searchInput"),this.searchBtn=document.getElementById("searchBtn"),this.kbTableOutput=document.getElementById("kbTableOutput"),this.addEntryBtn=document.getElementById("addEntryBtn"),this.deleteSelectedBtn=document.getElementById("deleteSelectedBtn"),this.sourceLang=document.getElementById("sourceLang"),this.targetLang=document.getElementById("targetLang"),window.knowledgeBaseManagerInstance?console.log("检测到已存在知识库管理器实例，跳过事件监听器初始化"):(console.log("初始化知识库管理器事件监听器和数据库"),this.initEventListeners(),this.initDatabase(),window.knowledgeBaseManagerInstance=this)}initEventListeners(){this.uploadBtn.addEventListener("click",(()=>{this.fileInput.click()})),this.fileInput.addEventListener("change",(n=>{const e=n.target;e.files&&e.files.length>0&&(this.selectedFile=e.files[0],this.fileName.textContent=this.selectedFile.name,this.actionButtons.style.display="block",this.log(`已选择文件: ${this.selectedFile.name}`))})),this.importBtn.addEventListener("click",(()=>k(this,void 0,void 0,(function*(){if(this.selectedFile)try{this.importBtn.disabled=!0,this.log("开始导入数据..."),this.showProgress(0),this.progressDetails.style.display="block",this.progressDetails.textContent="正在处理...";const n=yield w.importExcelToDatabase(this.selectedFile);this.showProgress(100),this.progressDetails.textContent=`已完成: ${n} 条目`,this.log(`成功导入 ${n} 条翻译条目到数据库`),yield this.loadEntries()}catch(n){this.log(`导入失败: ${n.message}`,"error"),this.showProgress(0)}finally{this.importBtn.disabled=!1}else this.log("请先选择一个Excel文件","error")})))),this.exportBtn.addEventListener("click",(()=>k(this,void 0,void 0,(function*(){try{this.exportBtn.disabled=!0,this.log("开始导出数据...");const n=yield v.getEntries(void 0,1e4,0);if(0===n.length)return void this.log("没有数据可导出","warning");const e=f.utils.book_new(),t=f.utils.json_to_sheet(n);f.utils.book_append_sheet(e,t,"翻译数据"),f.writeFile(e,"翻译知识库导出.xlsx"),this.log(`成功导出 ${n.length} 条翻译条目`)}catch(n){this.log(`导出失败: ${n.message}`,"error")}finally{this.exportBtn.disabled=!1}})))),this.searchBtn.addEventListener("click",(()=>k(this,void 0,void 0,(function*(){const n=this.searchInput.value.trim();yield this.loadEntries(n)})))),this.searchInput.addEventListener("keyup",(n=>k(this,void 0,void 0,(function*(){if("Enter"===n.key){const n=this.searchInput.value.trim();yield this.loadEntries(n)}})))),this.addEntryBtn.addEventListener("click",(()=>{this.showAddEntryForm()})),this.deleteSelectedBtn.addEventListener("click",(()=>k(this,void 0,void 0,(function*(){const n=this.getSelectedEntryIds();if(0!==n.length){if(confirm(`确定要删除选中的 ${n.length} 条记录吗？`))try{let e=0;for(const t of n)(yield v.deleteEntry(t))&&e++;this.log(`成功删除 ${e} 条记录`),yield this.loadEntries()}catch(n){this.log(`删除失败: ${n.message}`,"error")}}else this.log("请先选择要删除的条目","warning")}))))}initDatabase(){return k(this,void 0,void 0,(function*(){try{yield v.initializeDatabase(),this.log("数据库连接成功"),yield this.loadEntries()}catch(n){this.log(`数据库初始化失败: ${n.message}`,"error")}}))}loadEntries(n){return k(this,void 0,void 0,(function*(){try{this.log("加载翻译条目..."),this.currentEntries=yield v.getEntries(n),this.renderEntriesTable(this.currentEntries),this.log(`已加载 ${this.currentEntries.length} 条翻译条目`)}catch(n){this.log(`加载条目失败: ${n.message}`,"error")}}))}renderEntriesTable(n){if(0===n.length)return void(this.kbTableOutput.innerHTML='<div class="empty-state">没有找到翻译条目</div>');let e='\n            <table class="kb-table">\n                <thead>\n                    <tr>\n                        <th><input type="checkbox" id="selectAll"></th>\n                        <th>ID</th>\n                        <th>中文</th>\n                        <th>英语</th>\n                        <th>日语</th>\n                        <th>操作</th>\n                    </tr>\n                </thead>\n                <tbody>\n        ';n.forEach((n=>{e+=`\n                <tr data-id="${n.id}">\n                    <td><input type="checkbox" class="entry-checkbox"></td>\n                    <td>${n.id}</td>\n                    <td>${this.escapeHtml(n.Chinese)}</td>\n                    <td>${this.escapeHtml(n.English)}</td>\n                    <td>${this.escapeHtml(n.Japanese)}</td>\n                    <td>\n                        <button class="btn-small view-btn">查看</button>\n                        <button class="btn-small edit-btn">编辑</button>\n                        <button class="btn-small delete-btn">删除</button>\n                    </td>\n                </tr>\n            `})),e+="\n                </tbody>\n            </table>\n        ",this.kbTableOutput.innerHTML=e;const t=document.getElementById("selectAll");t.addEventListener("change",(()=>{document.querySelectorAll(".entry-checkbox").forEach((n=>{n.checked=t.checked}))})),document.querySelectorAll(".view-btn").forEach((n=>{n.addEventListener("click",(n=>{const e=n.target.closest("tr"),t=Number(null==e?void 0:e.getAttribute("data-id")),o=this.currentEntries.find((n=>n.id===t));o&&this.showEntryDetails(o)}))})),document.querySelectorAll(".edit-btn").forEach((n=>{n.addEventListener("click",(n=>{const e=n.target.closest("tr"),t=Number(null==e?void 0:e.getAttribute("data-id")),o=this.currentEntries.find((n=>n.id===t));o&&this.showEditEntryForm(o)}))})),document.querySelectorAll(".delete-btn").forEach((n=>{n.addEventListener("click",(n=>k(this,void 0,void 0,(function*(){const e=n.target.closest("tr"),t=Number(null==e?void 0:e.getAttribute("data-id"));if(confirm("确定要删除这条记录吗？"))try{(yield v.deleteEntry(t))?(this.log(`成功删除ID为 ${t} 的记录`),yield this.loadEntries()):this.log(`删除ID为 ${t} 的记录失败`,"error")}catch(n){this.log(`删除失败: ${n.message}`,"error")}}))))}))}showEntryDetails(n){const e=document.createElement("div");e.className="modal";let t=`\n            <div class="modal-content">\n                <span class="close">&times;</span>\n                <h2>条目详情 (ID: ${n.id})</h2>\n                <div class="entry-details">\n        `;[{code:"Chinese",name:"中文"},{code:"English",name:"英语"},{code:"Japanese",name:"日语"},{code:"Korean",name:"韩语"},{code:"Spanish",name:"西班牙语"},{code:"French",name:"法语"},{code:"German",name:"德语"},{code:"Russian",name:"俄语"},{code:"Thai",name:"泰语"},{code:"Italian",name:"意大利语"},{code:"Indonesian",name:"印尼语"},{code:"Portuguese",name:"葡萄牙语"}].forEach((e=>{t+=`\n                <div class="detail-item">\n                    <div class="detail-label">${e.name}:</div>\n                    <div class="detail-value">${this.escapeHtml(n[e.code]||"")}</div>\n                </div>\n            `})),t+="\n                </div>\n            </div>\n        ",e.innerHTML=t,document.body.appendChild(e),e.querySelector(".close").addEventListener("click",(()=>{document.body.removeChild(e)})),window.addEventListener("click",(n=>{n.target===e&&document.body.removeChild(e)}))}showEditEntryForm(n){const e=document.createElement("div");e.className="modal";let t=`\n            <div class="modal-content">\n                <span class="close">&times;</span>\n                <h2>编辑条目 (ID: ${n.id})</h2>\n                <form id="editEntryForm">\n        `;const o=[{code:"Chinese",name:"中文"},{code:"English",name:"英语"},{code:"Japanese",name:"日语"},{code:"Korean",name:"韩语"},{code:"Spanish",name:"西班牙语"},{code:"French",name:"法语"},{code:"German",name:"德语"},{code:"Russian",name:"俄语"},{code:"Thai",name:"泰语"},{code:"Italian",name:"意大利语"},{code:"Indonesian",name:"印尼语"},{code:"Portuguese",name:"葡萄牙语"}];o.forEach((e=>{t+=`\n                <div class="form-group">\n                    <label for="${e.code}">${e.name}:</label>\n                    <textarea id="${e.code}" name="${e.code}" rows="2">${this.escapeHtml(n[e.code]||"")}</textarea>\n                </div>\n            `})),t+='\n                    <div class="form-actions">\n                        <button type="submit" class="btn">保存</button>\n                        <button type="button" class="btn btn-cancel">取消</button>\n                    </div>\n                </form>\n            </div>\n        ',e.innerHTML=t,document.body.appendChild(e),e.querySelector(".close").addEventListener("click",(()=>{document.body.removeChild(e)})),e.querySelector(".btn-cancel").addEventListener("click",(()=>{document.body.removeChild(e)})),document.getElementById("editEntryForm").addEventListener("submit",(t=>k(this,void 0,void 0,(function*(){t.preventDefault();const r={};o.forEach((n=>{const e=document.getElementById(n.code);r[n.code]=e.value}));try{(yield v.updateEntry(n.id,r))?(this.log(`成功更新ID为 ${n.id} 的记录`),document.body.removeChild(e),yield this.loadEntries()):this.log(`更新ID为 ${n.id} 的记录失败`,"error")}catch(n){this.log(`更新失败: ${n.message}`,"error")}})))),window.addEventListener("click",(n=>{n.target===e&&document.body.removeChild(e)}))}showAddEntryForm(){const n=document.createElement("div");n.className="modal";let e='\n            <div class="modal-content">\n                <span class="close">&times;</span>\n                <h2>添加新条目</h2>\n                <form id="addEntryForm">\n        ';const t=[{code:"Chinese",name:"中文"},{code:"English",name:"英语"},{code:"Japanese",name:"日语"},{code:"Korean",name:"韩语"},{code:"Spanish",name:"西班牙语"},{code:"French",name:"法语"},{code:"German",name:"德语"},{code:"Russian",name:"俄语"},{code:"Thai",name:"泰语"},{code:"Italian",name:"意大利语"},{code:"Indonesian",name:"印尼语"},{code:"Portuguese",name:"葡萄牙语"}];t.forEach((n=>{e+=`\n                <div class="form-group">\n                    <label for="${n.code}">${n.name}:</label>\n                    <textarea id="${n.code}" name="${n.code}" rows="2"></textarea>\n                </div>\n            `})),e+='\n                    <div class="form-actions">\n                        <button type="submit" class="btn">保存</button>\n                        <button type="button" class="btn btn-cancel">取消</button>\n                    </div>\n                </form>\n            </div>\n        ',n.innerHTML=e,document.body.appendChild(n),n.querySelector(".close").addEventListener("click",(()=>{document.body.removeChild(n)})),n.querySelector(".btn-cancel").addEventListener("click",(()=>{document.body.removeChild(n)})),document.getElementById("addEntryForm").addEventListener("submit",(e=>k(this,void 0,void 0,(function*(){e.preventDefault();const o={};t.forEach((n=>{const e=document.getElementById(n.code);o[n.code]=e.value}));try{const e=yield v.addEntry(o);this.log(`成功添加新记录，ID: ${e}`),document.body.removeChild(n),yield this.loadEntries()}catch(n){this.log(`添加失败: ${n.message}`,"error")}})))),window.addEventListener("click",(e=>{e.target===n&&document.body.removeChild(n)}))}getSelectedEntryIds(){const n=[];return document.querySelectorAll(".entry-checkbox:checked").forEach((e=>{const t=e.closest("tr");if(t){const e=Number(t.getAttribute("data-id"));isNaN(e)||n.push(e)}})),n}log(n,e="info"){const t=(new Date).toLocaleTimeString(),o=document.createElement("div");o.className=`log-item log-${e}`,o.innerHTML=`<span class="log-time">[${t}]</span> ${n}`,this.logOutput.appendChild(o),this.logOutput.scrollTop=this.logOutput.scrollHeight,console.log(`[${e.toUpperCase()}] ${n}`)}showProgress(n){this.progressFill.style.width=`${n}%`,this.progressText.textContent=`${n}%`}escapeHtml(n){return n?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}}document.addEventListener("DOMContentLoaded",(()=>{window.knowledgeBaseManagerInstance=new I}))},5340:()=>{},5638:()=>{},6089:()=>{},7215:()=>{},7316:()=>{},7556:n=>{function e(n){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=()=>[],e.resolve=e,e.id=7556,n.exports=e},7790:()=>{},7965:()=>{},8982:()=>{},9368:()=>{},9838:()=>{}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=e,n=[],o.O=(e,t,r,i)=>{if(!t){var a=1/0;for(c=0;c<n.length;c++){for(var[t,r,i]=n[c],s=!0,l=0;l<t.length;l++)(!1&i||a>=i)&&Object.keys(o.O).every((n=>o.O[n](t[l])))?t.splice(l--,1):(s=!1,i<a&&(a=i));if(s){n.splice(c--,1);var d=r();void 0!==d&&(e=d)}}return e}i=i||0;for(var c=n.length;c>0&&n[c-1][2]>i;c--)n[c]=n[c-1];n[c]=[t,r,i]},o.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return o.d(e,{a:e}),e},o.d=(n,e)=>{for(var t in e)o.o(e,t)&&!o.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),o.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),o.nmd=n=>(n.paths=[],n.children||(n.children=[]),n),(()=>{var n={450:0};o.O.j=e=>0===n[e];var e=(e,t)=>{var r,i,[a,s,l]=t,d=0;if(a.some((e=>0!==n[e]))){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(l)var c=l(o)}for(e&&e(t);d<a.length;d++)i=a[d],o.o(n,i)&&n[i]&&n[i][0](),n[i]=0;return o.O(c)},t=self.webpackChunkexcel_to_structured_data=self.webpackChunkexcel_to_structured_data||[];t.forEach(e.bind(null,0)),t.push=e.bind(null,t.push.bind(t))})(),o.nc=void 0;var r=o.O(void 0,[121],(()=>o(5070)));r=o.O(r)})();